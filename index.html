<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Chef s3cmd by vkhatri</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Chef s3cmd</h1>
        <p>Chef Cookbook to Install and Manage s3cmd for amazon s3 </p>

        <p class="view"><a href="https://github.com/vkhatri/chef-s3cmd-ng">View the Project on GitHub <small>vkhatri/chef-s3cmd-ng</small></a></p>


        <ul>
          <li><a href="https://github.com/vkhatri/chef-s3cmd-ng/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/vkhatri/chef-s3cmd-ng/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/vkhatri/chef-s3cmd-ng">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="s3cmd-ng-cookbook" class="anchor" href="#s3cmd-ng-cookbook" aria-hidden="true"><span class="octicon octicon-link"></span></a>s3cmd-ng Cookbook</h1>

<p><a href="https://travis-ci.org/vkhatri/chef-s3cmd-ng"><img src="https://travis-ci.org/vkhatri/chef-s3md-ng.svg?branch=master" alt="Build Status"></a></p>

<p>This is a <a href="https://www.chef.io/">Chef</a> cookbook to manage <a href="https://github.com/s3tools/s3cmd">s3cmd</a> using LWRP.</p>

<p>This cookbook allows to manage different s3cmd config files, sync a directory or sync a s3 file and it can be extracted to a directory.</p>

<h2>
<a id="repository" class="anchor" href="#repository" aria-hidden="true"><span class="octicon octicon-link"></span></a>Repository</h2>

<p><a href="https://github.com/vkhatri/chef-s3cmd-ng">https://github.com/vkhatri/chef-s3cmd-ng</a></p>

<h2>
<a id="cookbook-dependencies" class="anchor" href="#cookbook-dependencies" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cookbook Dependencies</h2>

<ul>
<li>apt</li>
<li>yum-epel</li>
</ul>

<h2>
<a id="recipes" class="anchor" href="#recipes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Recipes</h2>

<ul>
<li><p><code>s3cmd::default</code>      - default recipe (used for run_list)</p></li>
<li><p><code>s3cmd::install</code>      - install s3cmd</p></li>
</ul>

<h2>
<a id="attributes" class="anchor" href="#attributes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Attributes</h2>

<ul>
<li><p><code>default['s3cmd']['setup_epel']</code> (default: <code>true</code>): whether to setup epel repository using cookbook yum-epel</p></li>
<li><p><code>default['s3cmd']['user']</code> (default: <code>root</code>): s3cmd default user, used in lwrp</p></li>
<li><p><code>default['s3cmd']['group']</code> (default: <code>root</code>): s3cmd default group, used in lwrp</p></li>
<li><p><code>default['s3cmd']['mode']</code> (default: <code>0750</code>): s3cmd file/directories permission</p></li>
<li><p><code>default['s3cmd']['umask']</code> (default: <code>0027</code>): s3cmd file/directories umask</p></li>
<li><p><code>default['s3cmd']['manage_sync_dir']</code> (default: <code>true</code>): whether to manage s3 sync dir, used in lwrp <code>dir</code></p></li>
<li><p><code>default['s3cmd']['template_source']</code> (default: <code>s3cfg.conf.erb</code>): s3cmd config file template name for lwrp <code>s3cmd_cfg</code></p></li>
<li><p><code>default['s3cmd']['template_cookbook']</code> (default: <code>15</code>): s3cmd config file template cookbook name for lwrp <code>s3cmd_cfg</code></p></li>
<li><p><code>default['s3cmd']['download_dir']</code> (default: <code>/tmp</code>): s3 download location for lwrp <code>s3cmd_file</code></p></li>
<li><p><code>default['s3cmd']['file']</code> (default: <code>nil</code>): s3cmd default config file location for lwrp <code>s3cmd_cfg</code></p></li>
<li><p><code>default['s3cmd']['binary']</code> (default: <code>/usr/bin/s3cmd</code>): s3cmd binary command location, used by lwrp <code>s3cmd_dir</code> and <code>s3cmd_file</code></p></li>
<li><p><code>default['s3cmd']['config']['S3CMD_OPTION']</code> (default: <code>S3CMD_OPTION_VALUE</code>): s3cmd config file attributes for lwrp <code>s3cmd_cfg</code>, check lwrp resource file for more details</p></li>
</ul>

<h2>
<a id="lwrp-resources" class="anchor" href="#lwrp-resources" aria-hidden="true"><span class="octicon octicon-link"></span></a>LWRP Resources</h2>

<ul>
<li>
<code>s3cmd_cfg</code>: create s3cmd config file</li>
<li>
<code>s3cmd_file</code>: s3 get file resource which also supports tar file extract</li>
<li>
<code>s3cmd_dir</code>: s3 sync directory resource</li>
</ul>

<h2>
<a id="lwrp-s3cmd_cfg" class="anchor" href="#lwrp-s3cmd_cfg" aria-hidden="true"><span class="octicon octicon-link"></span></a>LWRP s3cmd_cfg</h2>

<p>LWRP <code>s3cmd_cfg</code> is used to create/delete s3cmd config file.</p>

<p><strong>Create a s3cmd config file</strong></p>

<pre><code>s3cmd_cfg "foo" do
  access_key "aws s3 access key"
  secret_key "aws s3 secret key"
  file "file location"
  user "user name"
  group "group name"
  region "aws region name, e.g. Singapore"
  option "value" ..
end
</code></pre>

<p><strong>Create a s3cmd config file from a databag</strong></p>

<pre><code>s3cmd_cfg "foo" do
  file "file location"
  user "user name"
  group "group name"
  databag "databag name for aws access/secret key"
  databag_item "databag item name to load access_key &amp; secret_key"
  databag_secret "encrypted databag secret if any"
  bucket_location "aws region name, e.g. Singapore"
  option "value" ..
end
</code></pre>

<p><strong>Delete a s3cmd config file</strong></p>

<pre><code>s3cmd_cfg "foo" do
  action :delete
end
</code></pre>

<p><strong>LWRP Options</strong></p>

<p>Parameters:</p>

<ul>
<li>
<em>file (default: <code>node['s3cmd']['file']</code>)</em> - s3cmd config file location</li>
<li>
<em>user (default: <code>node['s3cmd']['user']</code>)</em> - s3cmd config file user</li>
<li>
<em>group (default: <code>node['s3cmd']['group']</code>)</em> - s3cmd config file group</li>
<li>
<em>mode (default: <code>node['s3cmd']['mode']</code>)</em> - s3cmd config file mode</li>
<li>
<em>template_source (default: <code>node['s3cmd']['template_source']</code>)</em> - s3cmd config file template source</li>
<li>
<em>template_cookbook (default: <code>node['s3cmd']['template_cookbook']</code>)</em> - s3cmd config file template cookbook</li>
<li>
<em>databag (default: <code>node['s3cmd']['databag']</code>)</em> - data bag for <code>access_key</code> and <code>secret_key</code>
</li>
<li>
<em>databag_item (default: <code>node['s3cmd']['databag_item']</code>)</em> - data bag item</li>
<li><p><em>databag_secret (default: <code>node['s3cmd']['databag_secret']</code>)</em> - encrypted data bag secret</p></li>
<li><p><em>access_key (default: <code>node['s3cmd']['config']['access_key']</code>)</em> - s3cmd config access_key</p></li>
<li>
<em>secret_key (default: <code>node['s3cmd']['config']['secret_key']</code>)</em> - s3cmd config secret_key</li>
<li>
<em>bucket_location (default: <code>node['s3cmd']['config']['bucket_location']</code>)</em> - s3cmd config bucket_location / aws region</li>
<li>
<em>S3CMD_OPTION (default: <code>DEFAULT_VALUE</code>)</em> - s3cmd config option</li>
</ul>

<h2>
<a id="lwrp-s3cmd_dir" class="anchor" href="#lwrp-s3cmd_dir" aria-hidden="true"><span class="octicon octicon-link"></span></a>LWRP s3cmd_dir</h2>

<p>LWRP <code>s3cmd_dir</code> is a wrapper for <code>s3cmd sync</code>.</p>

<p><strong>Create a s3cmd sync dir resource</strong></p>

<pre><code>s3cmd_dir "foo" do
  s3cfg_file "s3cmd config file"
  s3_url "s3 bucket url"
  user "user name"
  group "group name"
  s3cmd_options "--option value --option value .. if any"
  sync_dir "local dir to sync s3 url to"
  verify_file "verify file, raie exception is missing"
  mode "dirs / files mode"
  umask "user umask"
  manage_sync_dir "whether to manage local sync dir"
end
</code></pre>

<p><strong>Delete a s3cmd sync dir</strong></p>

<pre><code>s3cmd_dir "foo" do
  action :delete
end
</code></pre>

<p><strong>LWRP Options</strong></p>

<p>Parameters:</p>

<ul>
<li>
<em>s3cfg_file (default: <code>nil</code>, required: <code>true</code>)</em> - s3cmd config file location</li>
<li>
<em>s3_url (default: <code>nil</code>, required: <code>true</code>)</em> - s3 bucket location to sync to <code>sync_dir</code>
</li>
<li>
<em>s3cmd_options (default: <code>nil</code>)</em> - s3cmd options for <code>s3cmd sync</code>
</li>
<li>
<em>sync_dir (default: <code>nil</code>, required: <code>true</code>)</em> - sync s3 url to this location</li>
<li>
<em>verify_file (default: <code>nil</code>)</em> - verify file / location in <code>sync_dir</code> after <code>s3cmd sync</code>, raise exception is missing</li>
<li>
<em>user (default: <code>node['s3cmd']['user']</code>)</em> - <code>sync_dir</code> file user ownership</li>
<li>
<em>group (default: <code>node['s3cmd']['group']</code>)</em> - <code>sync_dir</code>file group ownership</li>
<li>
<em>mode (default: <code>node['s3cmd']['mode']</code>)</em> - <code>sync_dir</code> file permissions</li>
<li>
<em>umask (default: <code>node['s3cmd']['umask']</code>)</em> - sync_dir user exec umask</li>
<li>
<em>manage_sync_dir (default: <code>node['s3cmd']['manage_sync_dir']</code>)</em> - whether to manage directory <code>sync_dir</code>
</li>
<li>
<em>s3_binary (default: <code>node['s3cmd']['binary']</code>)</em> - s3cmd command location</li>
</ul>

<h2>
<a id="lwrp-s3cmd_file" class="anchor" href="#lwrp-s3cmd_file" aria-hidden="true"><span class="octicon octicon-link"></span></a>LWRP s3cmd_file</h2>

<p>LWRP <code>s3cmd_dir</code> is a wrapper for <code>s3cmd sync</code>.</p>

<p><strong>Create a s3cmd sync dir resource</strong></p>

<pre><code>s3cmd_file "foo" do
  s3cfg_file "s3cmd config file"
  s3_url "s3 bucket file url"
  user "user name"
  group "group name"
  s3cmd_options "--option value --option value .. if any"
  download_dir "local dir to download s3 file"
  manage_download_dir true # whether to manage download_dir
  extract_dir "untar a tar file to this location"
  extract true # whether to extract a tar file
  mode "dirs / files mode"
  umask "user umask"
end
</code></pre>

<p><strong>Delete a s3cmd file</strong></p>

<pre><code>s3cmd_file "foo" do
  s3_url "s3 bucket file url"
  download_dir "download location"
  extract_dir "directory location" # delete extract directory if specified
  action :delete
end
</code></pre>

<p><strong>LWRP Options</strong></p>

<p>Parameters:</p>

<ul>
<li>
<em>s3cfg_file (default: <code>nil</code>, required: <code>true</code>)</em> - s3cmd config file location</li>
<li>
<em>s3_url (default: <code>nil</code>, required: <code>true</code>)</em> - s3 file location for <code>s3cmd get</code>
</li>
<li>
<em>s3cmd_options (default: <code>nil</code>)</em> - s3cmd options for <code>s3cmd get</code>
</li>
<li>
<em>download_dir (default: <code>node['s3cmd']['download_dir']</code>)</em> - download s3 file here</li>
<li>
<em>extract (default: <code>false</code>)</em> - whether to extract a tar file</li>
<li>
<em>extract_dir (default: <code>node['s3cmd']['download_dir']</code>)</em> - extract s3 tar file here</li>
<li>
<em>user (default: <code>node['s3cmd']['user']</code>)</em> - files user ownership</li>
<li>
<em>group (default: <code>node['s3cmd']['group']</code>)</em> - files group ownership</li>
<li>
<em>mode (default: <code>node['s3cmd']['mode']</code>)</em> - files permissions</li>
<li>
<em>umask (default: <code>node['s3cmd']['umask']</code>)</em> - files user exec umask</li>
<li>
<em>manage_download_dir (default: <code>node['s3cmd']['manage_sync_dir']</code>)</em> - whether to manage directory <code>download_dir</code>
</li>
<li>
<em>s3_binary (default: <code>node['s3cmd']['binary']</code>)</em> - s3cmd command location</li>
</ul>

<h2>
<a id="contributing" class="anchor" href="#contributing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contributing</h2>

<ol>
<li>Fork the repository on Github</li>
<li>Create a named feature branch (like <code>add_component_x</code>)</li>
<li>Write your change</li>
<li>Write tests for your change (if applicable)</li>
<li>Run the tests (<code>rake</code>), ensuring they all pass</li>
<li>Write new resource/attribute description to <code>README.md</code>
</li>
<li>Write description about changes to PR</li>
<li>Submit a Pull Request using Github</li>
</ol>

<h2>
<a id="copyright--license" class="anchor" href="#copyright--license" aria-hidden="true"><span class="octicon octicon-link"></span></a>Copyright &amp; License</h2>

<p>Authors:: Virender Khatri and <a href="https://github.com/vkhatri/chef-s3cmd/graphs/contributors">Contributors</a></p>

<pre>
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
</pre>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/vkhatri">vkhatri</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
